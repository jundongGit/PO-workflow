# 半自动更新功能使用指南

## 🎉 v1.4.0 新功能：半自动更新

从 v1.4.0 开始，Invoice Automation 支持**半自动更新**！

### ✨ 更新前 vs 更新后

#### ❌ 旧版本（v1.3.0及之前）
1. 检测到新版本
2. 显示更新通知
3. 点击"下载更新"→ 打开 GitHub Release 页面
4. 手动点击下载 ZIP 文件
5. 手动解压
6. 手动卸载旧版本
7. 手动加载新版本

#### ✅ 新版本（v1.4.0起）
1. 检测到新版本
2. 显示更新通知
3. 点击"下载更新"→ **自动下载并打开引导页面**
4. 等待下载完成
5. 按照图文指引完成更新（只需 4 步）

## 🚀 使用方法

### 方式 1：自动检查更新

扩展会每 24 小时自动检查一次更新。当发现新版本时：

1. **扩展图标显示 "NEW" 徽章**
2. **打开扩展弹窗，顶部显示更新横幅**

   ```
   ┌─────────────────────────────────┐
   │ 🎉 发现新版本 v1.5.0            │
   │ 新增功能1 • 新增功能2 • 新增功能3 │
   │ [下载更新] [稍后]                │
   └─────────────────────────────────┘
   ```

3. **点击"下载更新"按钮**

### 方式 2：手动检查更新

1. 打开扩展弹窗
2. 点击底部的"🔄 检查更新"链接
3. 如果有新版本，会显示更新横幅
4. 点击"下载更新"按钮

### 方式 3：通过设置页面

1. 点击扩展图标
2. 点击"⚙️ 设置"
3. 滚动到"更新设置"部分
4. 点击"🔄 立即检查更新"
5. 如果有新版本，会弹出通知

## 📥 自动下载流程

点击"下载更新"后：

### 1. 打开更新引导页面

浏览器会自动打开一个漂亮的更新引导页面：

```
┌──────────────────────────────────────┐
│        🚀 扩展更新                    │
│      准备更新到 v1.5.0               │
│                                       │
│   ⏬ 正在下载新版本...                │
│      请稍候，不要关闭此页面           │
│                                       │
└──────────────────────────────────────┘
```

### 2. 自动下载到 Downloads 文件夹

- 文件名：`InvoiceAutomation-ChromeExtension-v1.X.X.zip`
- 位置：系统默认的 Downloads 文件夹
- 大小：约 400-500 KB
- 时间：通常 1-2 秒

### 3. 下载完成后显示安装步骤

```
┌──────────────────────────────────────┐
│        ✅ 下载完成！                  │
│   请按照下方步骤完成更新             │
│                                       │
│  📦 保存位置：Downloads/Invoice...   │
│                                       │
│  ① 解压下载的 ZIP 文件               │
│  ② 打开 Chrome 扩展管理页面          │
│  ③ 移除旧版本                        │
│  ④ 加载新版本                        │
│                                       │
│  [📁 打开 Downloads] [🔧 扩展管理]  │
└──────────────────────────────────────┘
```

## 📖 详细安装步骤

下载完成后，按照页面上的 4 个步骤操作：

### 步骤 1：解压 ZIP 文件

1. 打开 Downloads 文件夹
2. 找到 `InvoiceAutomation-ChromeExtension-v1.X.X.zip`
3. 右键点击 → 选择"解压到当前文件夹"或"Extract Here"
4. 会生成一个同名文件夹

### 步骤 2：打开 Chrome 扩展管理页面

1. 点击页面上的"🔧 打开扩展管理页面"按钮
2. 或者在浏览器地址栏输入：`chrome://extensions/`
3. 按回车键

### 步骤 3：移除旧版本

1. 在扩展列表中找到"Invoice Automation for Procore"
2. 点击"移除"按钮
3. 确认移除

**注意**：您的设置（API Key等）会保留，不会丢失！

### 步骤 4：加载新版本

1. 确保"开发者模式"已开启（右上角开关）
2. 点击"加载已解压的扩展程序"按钮
3. 选择刚才解压的文件夹中的 **extension** 子文件夹
4. 点击"选择文件夹"

完成！新版本已安装。

## 💡 常见问题

### Q1: 为什么不能完全自动更新？

**A**: Chrome 扩展的安全限制：
- ✅ 从 Chrome Web Store 安装的扩展可以完全自动更新
- ❌ 开发者模式加载的扩展无法自动替换文件
- ✅ 我们提供了最接近自动更新的体验（半自动）

**如果需要完全自动更新**：
- 选项 1：将扩展发布到 Chrome Web Store（需要 $5 注册费）
- 选项 2：继续使用当前的半自动更新（免费且简单）

### Q2: 下载失败怎么办？

**A**: 引导页面会显示手动下载选项：
- 点击"手动下载"按钮
- 会打开 GitHub Release 页面
- 手动下载 ZIP 文件
- 然后按照步骤安装

### Q3: 更新后设置会丢失吗？

**A**: **不会！**所有设置都会保留：
- API Key
- 自动更新开关
- 所有其他配置

这些设置存储在 Chrome 的本地存储中，更新扩展不会影响。

### Q4: 可以跳过某个版本吗？

**A**: 可以，但不建议：
- 点击"稍后"可以暂时忽略更新
- 但下次打开弹窗还会提示
- 建议及时更新以获得最新功能和修复

### Q5: 如何关闭自动更新检查？

**A**:
1. 打开设置页面（⚙️ 设置）
2. 找到"更新设置"部分
3. 取消勾选"启用自动更新检查"
4. 保存设置

**注意**：不建议关闭，除非有特殊需求。

### Q6: 下载的文件可以删除吗？

**A**: 可以！
- 安装完成后，ZIP 文件和解压的文件夹都可以删除
- 不会影响已安装的扩展
- 建议清理以节省空间

### Q7: 多台电脑需要分别更新吗？

**A**: 是的：
- 每台电脑上的扩展需要单独更新
- 但更新过程在每台电脑上都很简单
- 设置需要在每台电脑上单独配置

### Q8: 更新后需要重新配置 API Key 吗？

**A**: **不需要！**
- API Key 和所有设置都会自动保留
- 更新完成后直接可用
- 无需任何重新配置

## 🎯 最佳实践

### 及时更新

- ✅ 看到更新通知后尽快更新
- ✅ 新版本通常包含bug修复和新功能
- ✅ 保持最新版本获得最佳体验

### 网络环境

- 下载需要访问 GitHub
- 如果网络不好，下载可能失败
- 建议在稳定的网络环境下更新

### 备份重要数据

- 虽然设置会保留，但建议：
- 记下您的 API Key（以防万一）
- 导出重要配置（如果有）

## 📊 更新统计

从 v1.4.0 开始，您可以在设置页面查看：
- 当前版本号
- 最后检查更新时间
- 手动触发检查更新

## 🔄 更新流程图

```
检测到新版本
    ↓
显示更新横幅
    ↓
用户点击"下载更新"
    ↓
自动下载 ZIP 文件
    ↓
打开更新引导页面
    ↓
显示下载进度
    ↓
下载完成，显示安装步骤
    ↓
用户按照4步操作
    ↓
更新完成！
```

## 🆚 版本对比

| 功能 | v1.3.0 | v1.4.0 |
|------|--------|--------|
| 检测新版本 | ✅ | ✅ |
| 显示更新通知 | ✅ | ✅ |
| 自动下载 | ❌ | ✅ |
| 引导页面 | ❌ | ✅ |
| 安装步骤说明 | 文字alert | 图文并茂 |
| 用户操作步骤 | 7步 | 4步 |
| 下载位置 | 手动选择 | 自动到Downloads |
| 体验评分 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

## 🎉 总结

v1.4.0 的半自动更新功能大大简化了更新流程：

✅ **自动下载** - 无需手动打开 GitHub
✅ **清晰指引** - 图文并茂的安装步骤
✅ **快捷操作** - 一键打开文件夹和扩展管理
✅ **设置保留** - 更新后无需重新配置
✅ **错误处理** - 下载失败提供手动选项

---

**现在就试试新的更新功能吧！** 🚀

如有问题，请访问：https://github.com/jundongGit/PO-workflow/issues
