# Invoice Automation - 版本更新历史

## v1.4.3 (2025-10-31)

### 🐛 重要修复
- **修复页面导航中断问题**: 解决了点击项目后页面跳转导致自动化中断的核心问题
- **状态持久化**: 使用 chrome.storage.local 保存执行状态，页面导航不丢失
- **自动恢复机制**: 新页面加载时自动检测并继续未完成的任务
- **消除死循环**: 不再重复执行项目选择步骤

### 🎯 技术改进
- 实现跨页面状态管理
- 30秒时间窗口保护，避免误恢复
- 智能步骤续接，从中断点继续执行
- 完善的错误处理和状态清理

### 📝 用户体验
- 执行流程更加流畅
- 不再出现"连接失败，重试"
- 和本地 Playwright 版本一样可靠
- 真正的一键自动化

---

## v1.4.2 (2025-10-30)

### 🔍 调试增强
- **增强点击事件**: 触发完整的鼠标事件序列（mousedown + mouseup + click）
- **详细 DEBUG 日志**: 显示选项查找、点击、URL变化等详细过程
- **URL 变化检测**: 监控页面导航，帮助诊断问题
- **所有选项列表**: 匹配失败时输出所有可用选项

### 📝 其他改进
- 改进日志输出格式
- 优化错误提示信息

---

## v1.4.1 (2025-10-30)

### 🐛 问题修复
- **修复项目搜索匹配问题**: 解决了 Client Order Number 与项目显示名称不一致导致的匹配失败
- **智能匹配策略**: 实现4种匹配策略确保找到正确项目
  - 策略1: 精确匹配完整编号 (如 "KIWIWASTE-006")
  - 策略2: 部分匹配编号前缀 (如 "KIWIWASTE")
  - 策略3: 模糊匹配关键词 (如 "kiwiw", 不区分大小写)
  - 策略4: 唯一选项自动选择
- **提高成功率**: 即使项目名称格式不同也能正确匹配 (如 "KIWIWASTE-006" → "Kiwiwaste Job - Hailes Road")

### 📝 其他改进
- 改进搜索日志输出，显示每种匹配策略的尝试过程
- 优化错误提示信息

---

## v1.4.0 (2025-10-30)

### ✨ 新增功能
- **半自动更新**: 一键下载并安装新版本
- **自动下载**: 点击"下载更新"后自动下载到 Downloads 文件夹
- **更新引导页面**: 图文并茂的详细安装步骤
- **下载监控**: 实时显示下载进度和状态
- **快捷操作**: 一键打开 Downloads 文件夹或扩展管理页面

### 🎨 界面改进
- 新增精美的更新引导页面
- 步骤式安装指引（1-2-3-4）
- 实时下载状态显示
- 动画效果和进度提示

### 🔧 权限变更
- 添加 `downloads` 权限用于自动下载
- 添加 `management` 权限用于扩展管理

### 📝 其他改进
- 优化更新流程用户体验
- 简化安装步骤说明
- 添加错误处理和重试机制

---

## v1.3.0 (2025-10-30)

### ✨ 新增功能
- **可视化操作步骤**: 自动化执行时可清楚看到每一步操作
- **浮动进度面板**: 右下角显示实时进度，不再遮挡页面内容
- **元素高亮效果**: 正在操作的元素会显示紫色发光边框
- **操作提示气泡**: 在操作元素上方显示当前动作说明
- **步骤进度显示**: 实时展示4个主要步骤的执行状态
- **API Key 配置界面**: 新增专业的设置页面用于配置 API Key

### 🎨 界面改进
- 全新右下角浮动面板设计（紫色渐变）
- 元素高亮脉冲动画效果
- 操作提示气泡弹跳动画
- 步骤进度图标（⏳ → 🔄 → ✓）
- 自动滚动跟随操作元素

### 🔧 功能增强
- 设置页面支持 API Key 配置
- API 连接测试功能
- 自定义 API 端点支持
- 自动更新开关控制

### 📝 其他改进
- 添加 `clickWithFeedback` 操作包装器
- 添加 `fillWithFeedback` 操作包装器
- 添加 `selectWithFeedback` 操作包装器
- 完善的可视化反馈文档

---

## v1.2.0 (2025-10-30)

### ✨ 新增功能
- **在线更新检查**: 支持自动检查最新版本
- **自动更新提醒**: 每24小时自动检查，发现新版本时通知用户
- **手动检查更新**: 用户可随时手动检查更新
- **更新横幅**: 发现新版本时在弹窗顶部显示更新信息
- **版本对比**: 智能比较版本号，确保准确识别新版本
- **Badge 提示**: 扩展图标显示 "NEW" 徽章
- **一键下载**: 直接打开下载页面

### 🎨 界面改进
- 新增更新横幅组件
- Footer 显示当前版本号
- 新增"检查更新"链接

### 📝 其他改进
- 添加 alarms 权限用于定时检查
- 使用 GitHub Raw URL 作为更新源（推荐）
- 完善的安装指引提示

---

## v1.1.1 (2025-10-30)

### 🐛 问题修复
- **修复连接错误**: 解决 "Could not establish connection" 错误
- **自动注入机制**: 自动检测并注入 content script
- **智能重试**: 连接失败时自动重试最多3次
- **页面刷新**: 自动刷新已打开的 Procore 页面确保状态正常

### ⚡ 性能优化
- 优化页面加载等待时间
- 改进 content script 就绪检测
- 增加 PING 机制快速检测脚本状态

### 📝 其他改进
- 更详细的日志输出,显示连接和注入过程
- 改进错误提示信息,更易理解

---

## v1.1.0 (2025-10-30)

### ✨ 新增功能
- **实时日志显示**: 在弹窗中显示自动化执行的详细日志
- **弹窗保持打开**: 执行自动化时弹窗不再关闭,可实时查看进度
- **状态保持**: 关闭弹窗后重新打开,仍能看到当前任务状态
- **停止执行功能**: 新增"停止执行"按钮,可随时中断自动化
- **执行步骤提示**: 显示当前执行的步骤 (1/4, 2/4, 3/4, 4/4)

### 🎨 界面改进
- 新增自动化执行界面,包含:
  - 状态指示器(运行中/完成/失败)带动画效果
  - 实时日志区域,支持滚动查看历史日志
  - 当前处理信息显示 (Invoice Number, PO Number, 金额)
  - 清除日志按钮
  - 处理新文件按钮

### 🐛 问题修复
- 修复弹窗关闭后无法查看执行状态的问题
- 优化日志消息显示,更加人性化的中文提示

---

## v1.0.0 (2025-10-29)

### ✨ 初始版本功能
- PDF 发票智能识别
  - 支持拖拽上传
  - AI 自动提取 Invoice Number, Client Order Number, Total Amount
  - 识别置信度显示
- Procore 自动化
  - 自动选择项目
  - 自动导航到 Commitments
  - 自动查找并打开 PO
  - 自动填充发票信息
- 信息手动编辑功能
- OpenAI GPT-4o 集成

### 🎨 界面特性
- 现代化渐变色设计
- 进度条和步骤指示器
- 置信度标签(高/中/低)
- 响应式布局

### 📦 支持平台
- Windows 7/8/10/11
- macOS 10.13+
- Chrome 88+

---

## 版本说明

版本号采用语义化版本控制 (Semantic Versioning):
- **主版本号** (Major): 重大功能变更或不兼容的 API 修改
- **次版本号** (Minor): 向下兼容的新功能
- **修订号** (Patch): 向下兼容的问题修正

当前版本: **v1.4.0**
